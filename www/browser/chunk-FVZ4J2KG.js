import{a as X}from"./chunk-RH4O7VWY.js";import{a as x}from"./chunk-6GAUFMC7.js";import{a as v}from"./chunk-NRKDQ5D2.js";import"./chunk-5AN2NTKU.js";import{A as j,B as f,Ea as U,G as d,J as u,Ka as q,N as b,O as M,P as O,Ra as H,Xa as G,Ya as J,ba as R,d as T,e as P,f as C,fa as W,g as a,ga as L,h as c,ia as w,ja as E,la as S,o as h,oa as F,q as g,qa as B,r as I,s as y,tb as K,ua as D,v as p,w as l,wa as z,x as N,xa as A,zb as Q}from"./chunk-4FIZF6KI.js";import"./chunk-B3I3XDBM.js";import"./chunk-QUJFQN2Y.js";import"./chunk-KSM42KW3.js";import"./chunk-KAYW723Y.js";import"./chunk-ZJWVYB4W.js";import"./chunk-WVHTM5RI.js";import"./chunk-IN6HLDFE.js";import"./chunk-GIMG75PD.js";import"./chunk-O5IUGFKF.js";import"./chunk-LHDZOLCP.js";import"./chunk-AEZ3F2AP.js";import"./chunk-7FY2OE2O.js";import"./chunk-5KM5ZX5B.js";import"./chunk-EAHJVID6.js";import"./chunk-FOH2II3V.js";import"./chunk-VZWY4NEG.js";import"./chunk-WI5MSH4N.js";import"./chunk-5SJVYNIP.js";import"./chunk-CKP3SGE2.js";import"./chunk-QLR5SVGL.js";import"./chunk-JHI3MBHO.js";var V=(()=>{class n{constructor(o,i,e){this.webservice=o,this.router=i,this.storageServie=e}login(o){return this.webservice.post("auth/login",o)}resendOTP(o){return this.webservice.post("auth/requestOTP",o)}static{this.\u0275fac=function(i){return new(i||n)(C(x),C(w),C(v))}}static{this.\u0275prov=T({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Y=(()=>{class n{constructor(o,i,e,r,s){this.activatedRoute=o,this.otpService=i,this.commonService=e,this.router=r,this.storgeService=s,this.otp={first:"",second:"",third:"",forth:""},this.activatedRoute.queryParams.subscribe(t=>{this.mobileNo=t.mobileNo})}getDummyUser(){return{_id:"demo_user_001",mobileNo:this.mobileNo||"9999999999",name:"Demo User",email:"demo@twinker.app",addresses:[{_id:"addr_001",fullAddress:"123 MG Road, Madurai, Tamil Nadu 625001",addressType:"Home",defaultAddress:!0,coords:{lat:9.9252,lng:78.1198},locality:{_id:"loc_001",name:"Madurai Central"}}]}}ngOnInit(){}otpController(o,i,e,r){if(o.target.value.length<1&&e)e.setFocus();else if(i&&o.target.value.length>0)i.setFocus();else return 0}verifyOtpAndLogin(){let o=`${this.otp.first}${this.otp.second}${this.otp.third}${this.otp.fourth}`;if(this.mobileNo&&o&&o.length===4){let i={mobileNo:this.mobileNo,otp:o};this.otpService.login(i).subscribe({next:e=>{e.status?(this.commonService.presentToast("bottom",e.message,"success"),e.data&&this.storgeService.saveUser(e.data),e.data&&e.data.addresses&&e.data.addresses.length?this.router.navigate(["/tabs/"]):this.router.navigate(["/shared/location-setup"])):this.commonService.presentToast("bottom",e.message,"danger")},error:e=>{let r=this.getDummyUser();this.storgeService.saveUser(r),this.commonService.presentToast("bottom","Logged in (demo mode)","success"),this.router.navigate(["/tabs/"])},complete:()=>{}})}}resentOtp(){if(this.mobileNo){let o={mobileNo:this.mobileNo};this.otpService.resendOTP(o).subscribe({next:i=>{i.status?this.commonService.presentToast("bottom",i.message,"success"):this.commonService.presentToast("bottom",i.message,"danger")},error:i=>{this.commonService.presentToast("bottom","OTP resent (demo mode)","success")},complete:()=>{}})}}static{this.\u0275fac=function(i){return new(i||n)(g(L),g(V),g(X),g(w),g(v))}}static{this.\u0275cmp=I({type:n,selectors:[["app-otp-verification"]],standalone:!1,decls:24,vars:4,consts:[["otp1",""],["otp2",""],["otp3",""],["otp4",""],[1,"otp-content"],[1,"otp-wrapper"],["fill","clear","routerLink","/login","routerDirection","back",1,"back-btn"],["slot","icon-only","name","arrow-back-outline","color","medium"],[1,"page-title"],[1,"page-subtitle"],[1,"otp-boxes"],["maxlength","1","inputmode","numeric",1,"otp-box",3,"ngModelChange","keyup","ngModel"],[1,"resend-section"],[1,"resend-text"],[1,"resend-link",3,"click"],["expand","block",1,"confirm-btn",3,"click"]],template:function(i,e){if(i&1){let r=j();p(0,"ion-content",4)(1,"div",5)(2,"ion-button",6),N(3,"ion-icon",7),l(),p(4,"h1",8),u(5,"Verification Code"),l(),p(6,"p",9),u(7,"We have sent the verification code to your mobile number"),l(),p(8,"div",10)(9,"ion-input",11,0),O("ngModelChange",function(t){return a(r),M(e.otp.first,t)||(e.otp.first=t),c(t)}),f("keyup",function(t){a(r);let m=d(10),_=d(12);return c(e.otpController(t,_,m,""))}),l(),p(11,"ion-input",11,1),O("ngModelChange",function(t){return a(r),M(e.otp.second,t)||(e.otp.second=t),c(t)}),f("keyup",function(t){a(r);let m=d(10),_=d(14);return c(e.otpController(t,_,m,m))}),l(),p(13,"ion-input",11,2),O("ngModelChange",function(t){return a(r),M(e.otp.third,t)||(e.otp.third=t),c(t)}),f("keyup",function(t){a(r);let m=d(12),_=d(16);return c(e.otpController(t,_,m,m))}),l(),p(15,"ion-input",11,3),O("ngModelChange",function(t){return a(r),M(e.otp.fourth,t)||(e.otp.fourth=t),c(t)}),f("keyup",function(t){a(r);let m=d(14);return c(e.otpController(t,"",m,m))}),l()(),p(17,"div",12)(18,"span",13),u(19,"Didn't receive code? "),l(),p(20,"span",14),f("click",function(){return a(r),c(e.resentOtp())}),u(21,"Resend"),l()(),p(22,"ion-button",15),f("click",function(){return a(r),c(e.verifyOtpAndLogin())}),u(23,"Confirm"),l()()()}i&2&&(h(9),b("ngModel",e.otp.first),h(2),b("ngModel",e.otp.second),h(2),b("ngModel",e.otp.third),h(2),b("ngModel",e.otp.fourth))},dependencies:[F,D,B,q,H,G,J,U,K,E],styles:[".otp-content[_ngcontent-%COMP%]{--ion-background-color: #ffffff}.otp-content[_ngcontent-%COMP%]   .otp-wrapper[_ngcontent-%COMP%]{padding:20px 28px 28px;max-width:420px;margin:0 auto}.otp-content[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{--padding-start: 0;--padding-end: 0;margin:0 0 24px -8px;height:36px}.otp-content[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:22px}.otp-content[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{font-family:latoBold,sans-serif;font-size:24px;font-weight:700;color:#1a1a1a;margin:0 0 8px}.otp-content[_ngcontent-%COMP%]   .page-subtitle[_ngcontent-%COMP%]{font-family:latoRegular,sans-serif;font-size:14px;color:#888;margin:0 0 36px;line-height:1.4}.otp-content[_ngcontent-%COMP%]   .otp-boxes[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:16px;margin-bottom:28px}.otp-content[_ngcontent-%COMP%]   .otp-boxes[_ngcontent-%COMP%]   .otp-box[_ngcontent-%COMP%]{width:55px;height:55px;min-width:55px;max-width:55px;border:1.5px solid #d0d0d0;border-radius:12px;text-align:center;font-size:22px;font-family:latoBold,sans-serif;color:#1a1a1a;--padding-start: 0;--padding-end: 0;--padding-top: 0;--padding-bottom: 0;--background: #ffffff;transition:border-color .2s ease}.otp-content[_ngcontent-%COMP%]   .otp-boxes[_ngcontent-%COMP%]   .otp-box.has-focus[_ngcontent-%COMP%]{border-color:#f5853f}.otp-content[_ngcontent-%COMP%]   .resend-section[_ngcontent-%COMP%]{text-align:center;margin-bottom:32px;font-family:latoRegular,sans-serif;font-size:14px}.otp-content[_ngcontent-%COMP%]   .resend-section[_ngcontent-%COMP%]   .resend-text[_ngcontent-%COMP%]{color:#888}.otp-content[_ngcontent-%COMP%]   .resend-section[_ngcontent-%COMP%]   .resend-link[_ngcontent-%COMP%]{color:#f5853f;font-family:latoBold,sans-serif;font-weight:600;cursor:pointer}.otp-content[_ngcontent-%COMP%]   .confirm-btn[_ngcontent-%COMP%]{--background: #F5853F;--border-radius: 30px;--box-shadow: none;height:50px;font-size:16px;font-family:latoBold,sans-serif;font-weight:600;letter-spacing:.5px;text-transform:none;--color: #ffffff}"]})}}return n})();var ie=[{path:"",component:Y}],Z=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=y({type:n})}static{this.\u0275inj=P({imports:[S.forChild(ie),S]})}}return n})();var Oe=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=y({type:n})}static{this.\u0275inj=P({providers:[x,V],imports:[R,z,Q,W,Z,A]})}}return n})();export{Oe as OtpVerificationPageModule};
