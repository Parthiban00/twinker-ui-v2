import{a as te}from"./chunk-3LO6F2N4.js";import{a as ee}from"./chunk-EVNIR4QR.js";import{a as Z}from"./chunk-4JZKBSDW.js";import"./chunk-5AN2NTKU.js";import{a as k}from"./chunk-UGG7OXGH.js";import{B as d,C as r,D as n,E as p,Fa as w,I as h,J as f,Ja as M,Jb as J,K as l,Lb as K,Nb as Q,Q as P,S as c,T as y,U as I,Ua as N,Ub as X,Xa as R,Zb as Y,aa as S,fb as $,gb as q,ja as V,l as B,m as C,ma as j,mb as H,n as A,na as F,o as _,p as g,ra as z,rb as W,sb as G,u as s,w as v,x as D,xa as U,y as b,z as u}from"./chunk-U3GTSJOD.js";import"./chunk-B3I3XDBM.js";import"./chunk-QUJFQN2Y.js";import"./chunk-KSM42KW3.js";import"./chunk-KAYW723Y.js";import"./chunk-ZJWVYB4W.js";import"./chunk-WVHTM5RI.js";import"./chunk-IN6HLDFE.js";import"./chunk-GIMG75PD.js";import"./chunk-O5IUGFKF.js";import"./chunk-LHDZOLCP.js";import"./chunk-AEZ3F2AP.js";import"./chunk-7FY2OE2O.js";import"./chunk-5KM5ZX5B.js";import"./chunk-EAHJVID6.js";import"./chunk-FOH2II3V.js";import"./chunk-VZWY4NEG.js";import"./chunk-WI5MSH4N.js";import"./chunk-5SJVYNIP.js";import"./chunk-CKP3SGE2.js";import"./chunk-QLR5SVGL.js";import{e as L}from"./chunk-JHI3MBHO.js";var ie=(()=>{class t{constructor(e,i,o){this.webservice=e,this.router=i,this.storageServie=o}getAllAddressByUserId(e){return this.webservice.get(`address/getAllAddressesByUserId/${e}`)}updateAddressStatusById(e,i){return this.webservice.patch(`address/updateAddressStatusById/${e}`,i)}deleteAddressById(e,i){return this.webservice.post(`address/deleteAddressById/${e}`,i)}checkServiceArea(e){return this.webservice.post("locality/checkServiceArea",e)}static{this.\u0275fac=function(i){return new(i||t)(A(Z),A(w),A(k))}}static{this.\u0275prov=B({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var T=t=>({"background-color":t}),E=t=>({color:t});function pe(t,m){t&1&&(r(0,"div",7),p(1,"ion-spinner",8),n())}function me(t,m){t&1&&(r(0,"span",34),c(1,"DEFAULT"),n())}function fe(t,m){if(t&1&&(r(0,"p",35),c(1),n()),t&2){let e=l(3);s(),I("Near: ",e.homeAddress.landmark)}}function _e(t,m){if(t&1){let e=h();r(0,"div",20),f("click",function(){_(e);let o=l(2);return g(o.setAsDefault(o.homeAddress))}),r(1,"div",21),p(2,"ion-icon",22),n(),r(3,"div",23)(4,"div",24)(5,"span",25),c(6),n(),u(7,me,2,0,"span",26),n(),r(8,"p",27),c(9),n(),u(10,fe,2,1,"p",28),n(),r(11,"div",29)(12,"ion-button",30),f("click",function(o){_(e);let a=l(2);return g(a.editAddress(a.homeAddress,o))}),p(13,"ion-icon",31),n(),r(14,"ion-button",32),f("click",function(o){_(e);let a=l(2);return g(a.confirmDelete(a.homeAddress,o))}),p(15,"ion-icon",33),n()()()}if(t&2){let e=l(2);P("default",e.homeAddress.defaultAddress),s(),d("ngStyle",S(9,T,e.getIconBg(e.homeAddress.addressType))),s(),d("name",e.getIcon(e.homeAddress.addressType))("ngStyle",S(11,E,e.getIconColor(e.homeAddress.addressType))),s(4),y(e.getTypeLabel(e.homeAddress.addressType)),s(),d("ngIf",e.homeAddress.defaultAddress),s(2),y(e.homeAddress.fullAddress),s(),d("ngIf",e.homeAddress.landmark)}}function ge(t,m){if(t&1){let e=h();r(0,"div",15),f("click",function(){_(e);let o=l(2);return g(o.addAddress("home"))}),r(1,"div",16),p(2,"ion-icon",36),n(),r(3,"span",18),c(4,"+ Add Home Address"),n()()}}function ue(t,m){t&1&&(r(0,"span",34),c(1,"DEFAULT"),n())}function ve(t,m){if(t&1&&(r(0,"p",35),c(1),n()),t&2){let e=l(3);s(),I("Near: ",e.officeAddress.landmark)}}function xe(t,m){if(t&1){let e=h();r(0,"div",20),f("click",function(){_(e);let o=l(2);return g(o.setAsDefault(o.officeAddress))}),r(1,"div",21),p(2,"ion-icon",22),n(),r(3,"div",23)(4,"div",24)(5,"span",25),c(6),n(),u(7,ue,2,0,"span",26),n(),r(8,"p",27),c(9),n(),u(10,ve,2,1,"p",28),n(),r(11,"div",29)(12,"ion-button",30),f("click",function(o){_(e);let a=l(2);return g(a.editAddress(a.officeAddress,o))}),p(13,"ion-icon",31),n(),r(14,"ion-button",32),f("click",function(o){_(e);let a=l(2);return g(a.confirmDelete(a.officeAddress,o))}),p(15,"ion-icon",33),n()()()}if(t&2){let e=l(2);P("default",e.officeAddress.defaultAddress),s(),d("ngStyle",S(9,T,e.getIconBg(e.officeAddress.addressType))),s(),d("name",e.getIcon(e.officeAddress.addressType))("ngStyle",S(11,E,e.getIconColor(e.officeAddress.addressType))),s(4),y(e.getTypeLabel(e.officeAddress.addressType)),s(),d("ngIf",e.officeAddress.defaultAddress),s(2),y(e.officeAddress.fullAddress),s(),d("ngIf",e.officeAddress.landmark)}}function he(t,m){if(t&1){let e=h();r(0,"div",15),f("click",function(){_(e);let o=l(2);return g(o.addAddress("officeWork"))}),r(1,"div",16),p(2,"ion-icon",37),n(),r(3,"span",18),c(4,"+ Add Office Address"),n()()}}function ye(t,m){t&1&&(r(0,"span",34),c(1,"DEFAULT"),n())}function Se(t,m){if(t&1&&(r(0,"p",35),c(1),n()),t&2){let e=l().$implicit;s(),I("Near: ",e.landmark)}}function Ce(t,m){if(t&1){let e=h();r(0,"div",20),f("click",function(){let o=_(e).$implicit,a=l(2);return g(a.setAsDefault(o))}),r(1,"div",21),p(2,"ion-icon",22),n(),r(3,"div",23)(4,"div",24)(5,"span",25),c(6),n(),u(7,ye,2,0,"span",26),n(),r(8,"p",27),c(9),n(),u(10,Se,2,1,"p",28),n(),r(11,"div",29)(12,"ion-button",30),f("click",function(o){let a=_(e).$implicit,x=l(2);return g(x.editAddress(a,o))}),p(13,"ion-icon",31),n(),r(14,"ion-button",32),f("click",function(o){let a=_(e).$implicit,x=l(2);return g(x.confirmDelete(a,o))}),p(15,"ion-icon",33),n()()()}if(t&2){let e=m.$implicit,i=l(2);P("default",e.defaultAddress),s(),d("ngStyle",S(9,T,i.getIconBg(e.addressType))),s(),d("name",i.getIcon(e.addressType))("ngStyle",S(11,E,i.getIconColor(e.addressType))),s(4),y(i.getTypeLabel(e.addressType)),s(),d("ngIf",e.defaultAddress),s(2),y(e.fullAddress),s(),d("ngIf",e.landmark)}}function Ae(t,m){t&1&&(r(0,"div",38)(1,"div",39),p(2,"ion-icon",40),n(),r(3,"h3"),c(4,"No addresses saved"),n(),r(5,"p"),c(6,"Add your first address to get started"),n()())}function be(t,m){if(t&1){let e=h();r(0,"div",9)(1,"div",10)(2,"div",11),c(3,"Home & Office"),n(),u(4,_e,16,13,"div",12)(5,ge,5,0,"div",13)(6,xe,16,13,"div",12)(7,he,5,0,"div",13),n(),r(8,"div",10)(9,"div",11),c(10,"Other Addresses"),n(),u(11,Ce,16,13,"div",14),r(12,"div",15),f("click",function(){_(e);let o=l();return g(o.addAddress("others"))}),r(13,"div",16),p(14,"ion-icon",17),n(),r(15,"span",18),c(16,"+ Add Other Address"),n()()(),u(17,Ae,7,0,"div",19),n()}if(t&2){let e=l();s(4),d("ngIf",e.homeAddress),s(),d("ngIf",!e.homeAddress),s(),d("ngIf",e.officeAddress),s(),d("ngIf",!e.officeAddress),s(4),d("ngForOf",e.otherAddresses),s(6),d("ngIf",e.savedAddresses.length===0)}}var ne=(()=>{class t{constructor(e,i,o,a,x,re,se,ae){this.addressService=e,this.commonService=i,this.storageService=o,this.router=a,this.eventBus=x,this.alertCtrl=re,this.navCtrl=se,this.cdr=ae,this.savedAddresses=[],this.loading=!1}ngOnInit(){}ionViewWillEnter(){this.userData=this.storageService.getUser(),this.userData?this.getAllAddressByUserId(this.userData._id):this.commonService.presentToast("bottom","User details not found!","danger")}get homeAddress(){return this.savedAddresses.find(e=>e.addressType?.toLowerCase()==="home")||null}get officeAddress(){return this.savedAddresses.find(e=>e.addressType?.toLowerCase()==="officework")||null}get otherAddresses(){return this.savedAddresses.filter(e=>{let i=e.addressType?.toLowerCase();return i!=="home"&&i!=="officework"})}get takenTypes(){let e=[];return this.homeAddress&&e.push("home"),this.officeAddress&&e.push("officeWork"),e.join(",")}getAllAddressByUserId(e){this.loading=!0,this.addressService.getAllAddressByUserId(e).subscribe({next:i=>{this.loading=!1,i.status?this.savedAddresses=i.data||[]:(this.savedAddresses=[],this.commonService.presentToast("bottom",i.message,"danger")),this.cdr.detectChanges()},error:i=>{this.loading=!1,this.savedAddresses=[],this.commonService.presentToast("bottom",i.error?.message||"Error while fetching addresses!","danger"),this.cdr.detectChanges()}})}getIcon(e){switch(e?.toLowerCase()){case"home":return"home";case"officework":return"briefcase";default:return"location"}}getIconColor(e){switch(e?.toLowerCase()){case"home":return"#F85C70";case"officework":return"#4A5BF5";default:return"#2DBCB6"}}getIconBg(e){switch(e?.toLowerCase()){case"home":return"#fff0e6";case"officework":return"#e8f0ff";default:return"#e6f9f7"}}getTypeLabel(e){switch(e?.toLowerCase()){case"home":return"Home";case"officework":return"Office";default:return"Other"}}setAsDefault(e){e.defaultAddress||(e.coords?.lat&&e.coords?.lng?this.addressService.checkServiceArea(e.coords).subscribe({next:i=>{i.status&&i.data?.serviceAvailable?this.doSetDefault(e._id):this.commonService.presentToast("bottom","This address is outside our service area.","danger")},error:()=>{this.doSetDefault(e._id)}}):this.doSetDefault(e._id))}doSetDefault(e){let i={userId:this.userData._id,defaultAddress:!0};this.addressService.updateAddressStatusById(e,i).subscribe({next:o=>{o.status?(this.commonService.presentToast("bottom","Default address updated","success"),this.getAllAddressByUserId(this.userData._id),this.emitEvent()):this.commonService.presentToast("bottom",o.message,"danger")},error:o=>{this.commonService.presentToast("bottom",o.error?.message||"Error updating address!","danger")}})}confirmDelete(e,i){return L(this,null,function*(){i.stopPropagation(),yield(yield this.alertCtrl.create({header:"Delete Address",message:`Are you sure you want to delete this ${this.getTypeLabel(e.addressType)} address?`,cssClass:"delete-alert",buttons:[{text:"Cancel",role:"cancel"},{text:"Delete",cssClass:"danger-btn",handler:()=>{this.deleteAddress(e)}}]})).present()})}deleteAddress(e){let i={userId:this.userData._id};this.addressService.deleteAddressById(e._id,i).subscribe({next:o=>{if(o.status)if(this.commonService.presentToast("bottom","Address deleted","success"),e.defaultAddress){let a=this.savedAddresses.filter(x=>x._id!==e._id);a.length>0?this.doSetDefault(a[0]._id):(this.getAllAddressByUserId(this.userData._id),this.emitEvent())}else this.getAllAddressByUserId(this.userData._id),this.emitEvent();else this.commonService.presentToast("bottom",o.message,"danger")},error:o=>{this.commonService.presentToast("bottom",o.error?.message||"Error deleting address!","danger")}})}editAddress(e,i){i.stopPropagation(),this.router.navigate(["/shared/location-setup"],{queryParams:{mode:"edit",addressId:e._id,fullAddress:e.fullAddress,addressType:e.addressType,landmark:e.landmark||"",locality:e.locality?._id||"",lat:e.coords?.lat||"",lng:e.coords?.lng||"",takenTypes:this.takenTypes}})}addAddress(e){let i={takenTypes:this.takenTypes};e&&(i.presetType=e),this.router.navigate(["/shared/location-setup"],{queryParams:i})}goBack(){this.navCtrl.back()}emitEvent(){this.eventBus.emit("address-updated",{message:"Address Updated"})}static{this.\u0275fac=function(i){return new(i||t)(v(ie),v(ee),v(k),v(w),v(te),v(X),v(R),v(V))}}static{this.\u0275cmp=D({type:t,selectors:[["app-location-setup"]],standalone:!1,decls:10,vars:2,consts:[[1,"ion-no-border"],["slot","start"],["fill","clear",3,"click"],["slot","icon-only","name","arrow-back-outline"],[1,"address-content"],["class","loading-wrap",4,"ngIf"],["class","address-page",4,"ngIf"],[1,"loading-wrap"],["name","crescent","color","primary"],[1,"address-page"],[1,"section"],[1,"section-label"],["class","address-card",3,"default","click",4,"ngIf"],["class","add-slot-card",3,"click",4,"ngIf"],["class","address-card",3,"default","click",4,"ngFor","ngForOf"],[1,"add-slot-card",3,"click"],[1,"add-slot-icon"],["name","add-circle-outline"],[1,"add-slot-text"],["class","empty-state",4,"ngIf"],[1,"address-card",3,"click"],[1,"card-icon",3,"ngStyle"],[3,"name","ngStyle"],[1,"card-info"],[1,"card-top"],[1,"type-label"],["class","default-badge",4,"ngIf"],[1,"card-address"],["class","card-landmark",4,"ngIf"],[1,"card-actions"],["fill","clear",1,"edit-btn",3,"click"],["slot","icon-only","name","create-outline"],["fill","clear",1,"delete-btn",3,"click"],["slot","icon-only","name","trash-outline"],[1,"default-badge"],[1,"card-landmark"],["name","home-outline"],["name","briefcase-outline"],[1,"empty-state"],[1,"empty-icon"],["name","location-outline"]],template:function(i,o){i&1&&(r(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1)(3,"ion-button",2),f("click",function(){return o.goBack()}),p(4,"ion-icon",3),n()(),r(5,"ion-title"),c(6,"My Addresses"),n()()(),r(7,"ion-content",4),u(8,pe,2,0,"div",5)(9,be,18,6,"div",6),n()),i&2&&(s(8),d("ngIf",o.loading),s(),d("ngIf",!o.loading))},dependencies:[j,F,z,$,q,H,W,G,J,K,Q],styles:[".address-content[_ngcontent-%COMP%]{--ion-background-color: #f5f5f5}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: #ffffff;--color: #1a1a1a;--border-width: 0}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{font-family:latoBold,sans-serif;font-size:17px;color:#1a1a1a}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--color: #1a1a1a;color:#1a1a1a}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:22px;color:#1a1a1a}.loading-wrap[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:80px 0}.loading-wrap[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{width:36px;height:36px;--color: #F85C70}.address-page[_ngcontent-%COMP%]{padding:16px}.section[_ngcontent-%COMP%]{margin-bottom:24px}.section-label[_ngcontent-%COMP%]{font-family:latoBold,sans-serif;font-size:12px;color:#888;text-transform:uppercase;letter-spacing:.8px;margin-bottom:12px;padding-left:2px}.address-card[_ngcontent-%COMP%]{display:flex;align-items:flex-start;background:#fff;border-radius:14px;padding:16px;margin-bottom:12px;box-shadow:0 2px 8px #0000000f;cursor:pointer;transition:box-shadow .2s ease,border-color .2s ease;border-left:3px solid transparent}.address-card.default[_ngcontent-%COMP%]{border-left-color:#f85c70;box-shadow:0 2px 12px #f85c701f}.address-card[_ngcontent-%COMP%]:active{background:#fafafa}.card-icon[_ngcontent-%COMP%]{width:44px;height:44px;min-width:44px;border-radius:12px;display:flex;align-items:center;justify-content:center;margin-right:12px}.card-icon[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px}.card-info[_ngcontent-%COMP%]{flex:1;min-width:0;padding-top:2px}.card-top[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:4px}.type-label[_ngcontent-%COMP%]{font-family:latoBold,sans-serif;font-size:15px;color:#1a1a1a}.default-badge[_ngcontent-%COMP%]{font-family:latoBold,sans-serif;font-size:10px;color:#f85c70;background:#f85c701a;padding:2px 8px;border-radius:10px;letter-spacing:.5px}.card-address[_ngcontent-%COMP%]{font-family:latoRegular,sans-serif;font-size:13px;color:#888;line-height:1.4;margin:0;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.card-landmark[_ngcontent-%COMP%]{font-family:latoLight,sans-serif;font-size:12px;color:#aaa;margin:3px 0 0}.card-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:0;margin-left:4px}.card-actions[_ngcontent-%COMP%]   .edit-btn[_ngcontent-%COMP%], .card-actions[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]{--padding-start: 6px;--padding-end: 6px;--color: #888;margin:0;height:32px;min-height:32px}.card-actions[_ngcontent-%COMP%]   .edit-btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .card-actions[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.card-actions[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]{--color: #cc4444}.add-slot-card[_ngcontent-%COMP%]{display:flex;align-items:center;border:1.5px dashed #d0d0d0;border-radius:14px;padding:16px;margin-bottom:12px;cursor:pointer;background:transparent;transition:background .15s ease}.add-slot-card[_ngcontent-%COMP%]:active{background:#00000005}.add-slot-icon[_ngcontent-%COMP%]{width:44px;height:44px;min-width:44px;border-radius:12px;background:#f0f0f0;display:flex;align-items:center;justify-content:center;margin-right:12px}.add-slot-icon[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;color:#aaa}.add-slot-text[_ngcontent-%COMP%]{font-family:latoRegular,sans-serif;font-size:14px;color:#aaa}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 32px;text-align:center}.empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;background:#fff0e6;display:flex;align-items:center;justify-content:center;margin-bottom:20px}.empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:36px;color:#f85c70}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-family:latoBold,sans-serif;font-size:18px;color:#1a1a1a;margin:0 0 8px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-family:latoRegular,sans-serif;font-size:14px;color:#888;margin:0}"]})}}return t})();var Pe=[{path:"",component:ne}],oe=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=b({type:t})}static{this.\u0275inj=C({imports:[M.forChild(Pe),M]})}}return t})();var Re=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=b({type:t})}static{this.\u0275inj=C({imports:[U,N,Y,oe]})}}return t})();export{Re as LocationSetupPageModule};
