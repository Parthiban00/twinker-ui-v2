import{a as Y}from"./chunk-OA5Y5QZK.js";import{a as w}from"./chunk-6A6XL2SI.js";import{a as X}from"./chunk-M3KTG2EL.js";import"./chunk-5AN2NTKU.js";import{a as Q}from"./chunk-WLU3HJCS.js";import{A as M,B as k,Ba as j,C as v,D as a,Da as F,E as r,F as T,Gb as J,Ha as L,I as y,J as g,Ja as B,K as x,Ka as z,Mb as K,O as m,R as u,Ra as A,T as I,W as b,X as O,Xa as q,Y as C,cb as U,ib as G,ja as R,jb as H,m as P,na as N,o as c,p,ta as W,va as D,w as f,wa as E,y as _,ya as V,z as S}from"./chunk-AO5VP27J.js";import"./chunk-B3I3XDBM.js";import"./chunk-QUJFQN2Y.js";import"./chunk-KSM42KW3.js";import"./chunk-KAYW723Y.js";import"./chunk-ZJWVYB4W.js";import"./chunk-WVHTM5RI.js";import"./chunk-IN6HLDFE.js";import"./chunk-GIMG75PD.js";import"./chunk-O5IUGFKF.js";import"./chunk-LHDZOLCP.js";import"./chunk-AEZ3F2AP.js";import"./chunk-7FY2OE2O.js";import"./chunk-5KM5ZX5B.js";import"./chunk-EAHJVID6.js";import"./chunk-FOH2II3V.js";import"./chunk-VZWY4NEG.js";import"./chunk-WI5MSH4N.js";import"./chunk-5SJVYNIP.js";import"./chunk-CKP3SGE2.js";import"./chunk-QLR5SVGL.js";import"./chunk-JHI3MBHO.js";function ne(i,te){if(i&1&&(a(0,"span",17),u(1),r()),i&2){let o=x();f(),I("Resend OTP in ",o.resendCountdown,"s")}}function ie(i,te){if(i&1){let o=y();a(0,"span",18),g("click",function(){c(o);let e=x();return p(e.resentOtp())}),u(1,"Resend OTP"),r()}}var $=(()=>{class i{constructor(o,n,e,s,l){this.activatedRoute=o,this.otpService=n,this.commonService=e,this.router=s,this.storageService=l,this.otp={first:"",second:"",third:"",fourth:""},this.resendDisabled=!0,this.resendCountdown=20,this.activatedRoute.queryParams.subscribe(t=>{this.mobileNo=t.mobileNo})}ngOnInit(){this.startResendTimer()}ngOnDestroy(){this.clearResendTimer()}startResendTimer(){this.resendDisabled=!0,this.resendCountdown=20,this.clearResendTimer(),this.resendInterval=setInterval(()=>{this.resendCountdown--,this.resendCountdown<=0&&(this.resendDisabled=!1,this.clearResendTimer())},1e3)}clearResendTimer(){this.resendInterval&&(clearInterval(this.resendInterval),this.resendInterval=null)}otpController(o,n,e,s){if(o.target.value.length<1&&e)e.setFocus();else if(n&&o.target.value.length>0)n.setFocus();else return 0}verifyOtpAndLogin(){let o=`${this.otp.first}${this.otp.second}${this.otp.third}${this.otp.fourth}`;if(this.mobileNo&&o&&o.length===4){let n={mobileNo:this.mobileNo,otp:o};this.otpService.login(n).subscribe({next:e=>{e.status?(this.commonService.presentToast("bottom",e.message,"success"),e.data&&(e.data.token&&this.storageService.saveToken(e.data.token),e.data.user&&this.storageService.saveUser(e.data.user),e.data.hasDefaultAddress?this.router.navigate(["/tabs/"]):this.router.navigate(["/shared/location-setup"]))):this.commonService.presentToast("bottom",e.message,"danger")},error:e=>{this.commonService.presentToast("bottom","Invalid OTP or verification failed. Please try again.","danger")},complete:()=>{}})}}resentOtp(){if(this.mobileNo&&!this.resendDisabled){let o={mobileNo:this.mobileNo};this.otpService.resendOTP(o).subscribe({next:n=>{n.status?(this.commonService.presentToast("bottom",n.message,"success"),this.startResendTimer()):this.commonService.presentToast("bottom",n.message,"danger")},error:n=>{this.commonService.presentToast("bottom","Failed to resend OTP. Please try again.","danger")},complete:()=>{}})}}static{this.\u0275fac=function(n){return new(n||i)(_(W),_(w),_(Y),_(D),_(Q))}}static{this.\u0275cmp=S({type:i,selectors:[["app-otp-verification"]],standalone:!1,decls:24,vars:6,consts:[["otp1",""],["otp2",""],["otp3",""],["otp4",""],[1,"otp-content"],[1,"otp-wrapper"],["fill","clear","routerLink","/login","routerDirection","back",1,"back-btn"],["slot","icon-only","name","arrow-back-outline","color","medium"],[1,"page-title"],[1,"page-subtitle"],[1,"otp-boxes"],["maxlength","1","inputmode","numeric",1,"otp-box",3,"ngModelChange","keyup","ngModel"],[1,"resend-section"],[1,"resend-text"],["class","resend-timer",4,"ngIf"],["class","resend-link",3,"click",4,"ngIf"],["expand","block",1,"confirm-btn",3,"click"],[1,"resend-timer"],[1,"resend-link",3,"click"]],template:function(n,e){if(n&1){let s=y();a(0,"ion-content",4)(1,"div",5)(2,"ion-button",6),T(3,"ion-icon",7),r(),a(4,"h1",8),u(5,"Verification Code"),r(),a(6,"p",9),u(7,"We have sent the verification code to your mobile number"),r(),a(8,"div",10)(9,"ion-input",11,0),C("ngModelChange",function(t){return c(s),O(e.otp.first,t)||(e.otp.first=t),p(t)}),g("keyup",function(t){c(s);let d=m(10),h=m(12);return p(e.otpController(t,h,d,""))}),r(),a(11,"ion-input",11,1),C("ngModelChange",function(t){return c(s),O(e.otp.second,t)||(e.otp.second=t),p(t)}),g("keyup",function(t){c(s);let d=m(10),h=m(14);return p(e.otpController(t,h,d,d))}),r(),a(13,"ion-input",11,2),C("ngModelChange",function(t){return c(s),O(e.otp.third,t)||(e.otp.third=t),p(t)}),g("keyup",function(t){c(s);let d=m(12),h=m(16);return p(e.otpController(t,h,d,d))}),r(),a(15,"ion-input",11,3),C("ngModelChange",function(t){return c(s),O(e.otp.fourth,t)||(e.otp.fourth=t),p(t)}),g("keyup",function(t){c(s);let d=m(14);return p(e.otpController(t,"",d,d))}),r()(),a(17,"div",12)(18,"span",13),u(19,"Didn't receive code? "),r(),k(20,ne,2,1,"span",14)(21,ie,2,0,"span",15),r(),a(22,"ion-button",16),g("click",function(){return c(s),p(e.verifyOtpAndLogin())}),u(23,"Confirm"),r()()()}n&2&&(f(9),b("ngModel",e.otp.first),f(2),b("ngModel",e.otp.second),f(2),b("ngModel",e.otp.third),f(2),b("ngModel",e.otp.fourth),f(5),v("ngIf",e.resendDisabled),f(),v("ngIf",!e.resendDisabled))},dependencies:[R,j,L,F,q,U,G,H,A,J,E],styles:[".otp-content[_ngcontent-%COMP%]{--ion-background-color: #ffffff}.otp-content[_ngcontent-%COMP%]   .otp-wrapper[_ngcontent-%COMP%]{padding:20px 28px 28px;max-width:420px;margin:0 auto}.otp-content[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{--padding-start: 0;--padding-end: 0;margin:0 0 24px -8px;height:36px}.otp-content[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:22px}.otp-content[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{font-family:latoBold,sans-serif;font-size:24px;font-weight:700;color:#1a1a1a;margin:0 0 8px}.otp-content[_ngcontent-%COMP%]   .page-subtitle[_ngcontent-%COMP%]{font-family:latoRegular,sans-serif;font-size:14px;color:#888;margin:0 0 36px;line-height:1.4}.otp-content[_ngcontent-%COMP%]   .otp-boxes[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:16px;margin-bottom:28px}.otp-content[_ngcontent-%COMP%]   .otp-boxes[_ngcontent-%COMP%]   .otp-box[_ngcontent-%COMP%]{width:55px;height:55px;min-width:55px;max-width:55px;border:1.5px solid #d0d0d0;border-radius:12px;text-align:center;font-size:22px;font-family:latoBold,sans-serif;color:#1a1a1a;--padding-start: 0;--padding-end: 0;--padding-top: 0;--padding-bottom: 0;--background: #ffffff;transition:border-color .2s ease}.otp-content[_ngcontent-%COMP%]   .otp-boxes[_ngcontent-%COMP%]   .otp-box.has-focus[_ngcontent-%COMP%]{border-color:#f5853f}.otp-content[_ngcontent-%COMP%]   .resend-section[_ngcontent-%COMP%]{text-align:center;margin-bottom:32px;font-family:latoRegular,sans-serif;font-size:14px}.otp-content[_ngcontent-%COMP%]   .resend-section[_ngcontent-%COMP%]   .resend-text[_ngcontent-%COMP%]{color:#888}.otp-content[_ngcontent-%COMP%]   .resend-section[_ngcontent-%COMP%]   .resend-link[_ngcontent-%COMP%]{color:#f5853f;font-family:latoBold,sans-serif;font-weight:600;cursor:pointer}.otp-content[_ngcontent-%COMP%]   .confirm-btn[_ngcontent-%COMP%]{--background: #F5853F;--border-radius: 30px;--box-shadow: none;height:50px;font-size:16px;font-family:latoBold,sans-serif;font-weight:600;letter-spacing:.5px;text-transform:none;--color: #ffffff}"]})}}return i})();var oe=[{path:"",component:$}],ee=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=M({type:i})}static{this.\u0275inj=P({imports:[V.forChild(oe),V]})}}return i})();var ve=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=M({type:i})}static{this.\u0275inj=P({providers:[X,w],imports:[N,B,K,ee,z]})}}return i})();export{ve as OtpVerificationPageModule};
