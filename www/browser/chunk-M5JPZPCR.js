import{a as N}from"./chunk-ZOLN67DP.js";import{a as A}from"./chunk-NI26SNN6.js";import{a as D}from"./chunk-QDQTVTRV.js";import{a as z}from"./chunk-HDEIKT3L.js";import{B as _,Bb as E,D as d,E as o,F as i,G as p,L as f,Lb as k,M as g,Sa as O,T as c,Ub as R,V as s,Xa as M,bb as I,cb as y,ib as S,ja as b,jb as F,ka as C,kb as w,nb as T,ob as B,v as P,w as a,y as m,z as x}from"./chunk-IRT4PLLF.js";import{e as v}from"./chunk-JHI3MBHO.js";function U(r,u){if(r&1&&(o(0,"div",23),c(1),i()),r&2){let e=g().$implicit;a(),s("",e.discount,"% OFF")}}function j(r,u){if(r&1&&(o(0,"div",23),c(1),i()),r&2){let e=g().$implicit;a(),s("\u20B9",e.discount," OFF")}}function V(r,u){if(r&1&&(o(0,"div",10)(1,"div",11),_(2,U,2,1,"div",12)(3,j,2,1,"div",12),p(4,"img",13),i(),o(5,"div",14)(6,"div",15),c(7),i(),o(8,"div",16),c(9),i(),o(10,"div",17)(11,"div",18),c(12),i(),o(13,"div",19),c(14),i()(),o(15,"div",20)(16,"button",21),c(17,"-"),i(),o(18,"label"),c(19,"1"),i(),o(20,"button",22),c(21,"+"),i()()()()),r&2){let e=u.$implicit,t=g();a(2),d("ngIf",e.discountType==="in-percentage"),a(),d("ngIf",e.discountType==="in-price"),a(),d("src",t.imgBaseUrl+e.imageUrl,P),a(3),s(" ",e.productName," "),a(2),s(" (by\xA0",e.vendor.name,") "),a(3),s(" Rs: ",e.actualPrice," "),a(2),s(" Rs: ",e.price," ")}}var K=(()=>{class r{constructor(e,t,n,l){this.modalCtrl=e,this.navParams=t,this.homeService=n,this.commonService=l,this.imgBaseUrl=z.imageBaseUrl,this.featuredItems=[],this.dataForSearch=[],this.isOpen=!1,this.currentFilters={selectedVendor:null,priceRange:{lower:20,upper:500},offerType:null,offerPercentageRange:{lower:0,upper:100},offerPriceRange:{lower:0,upper:500}},this.receivedData=this.navParams.get("data"),console.log("Received data in modal:",this.receivedData),this.receivedData&&this.getFeaturedItemsByCategory(this.receivedData.category)}ngOnInit(){}cancel(){return this.modalCtrl.dismiss(null,"cancel")}confirm(){return this.modalCtrl.dismiss("data","confirm")}handleSearchInput(e){this.dataForSearch&&(this.featuredItems=this.searchProductByName(this.dataForSearch,e.target.value))}presentPopover(e){return v(this,null,function*(){let t=yield this.modalCtrl.create({component:D,componentProps:{vendors:this.vendors,currentFilters:this.currentFilters}});return t.onWillDismiss().then(n=>{n.role==="confirm"&&(console.log("Filter data:",n.data),this.applyFilters(n.data))}),yield t.present()})}searchProductByName(e,t){return e.filter(l=>l.productName.toLowerCase().includes(t.toLowerCase()))}getFeaturedItemsByCategory(e){this.homeService.getFeaturedItemsByCategory(e).subscribe({next:t=>{t.status?t.data?(this.featuredItems=t.data,this.dataForSearch=JSON.parse(JSON.stringify(this.featuredItems)),this.vendors=this.extractUniqueVendors(this.dataForSearch)):this.featuredItems=[]:this.commonService.presentToast("bottom",t.message,"danger")},error:t=>{this.commonService.presentToast("bottom",t.error.message?t.error.message:"Error while fetching featured items!","danger")},complete:()=>{}})}applyFilters(e){this.currentFilters=e,this.featuredItems=this.dataForSearch.filter(t=>{let n=!0;return e.selectedVendor&&t.vendor._id!==e.selectedVendor._id&&(n=!1),(t.price<e.priceRange.lower||t.price>e.priceRange.upper)&&(n=!1),e.offerType&&(e.offerType==="in-percentage"&&t.discountType!=="in-percentage"||e.offerType==="in-price"&&t.discountType!=="in-price")&&(n=!1),e.offerType==="in-percentage"&&(t.discount<e.offerPercentageRange.lower||t.discount>e.offerPercentageRange.upper)&&(n=!1),e.offerType==="in-price"&&(t.discount<e.offerPriceRange.lower||t.discount>e.offerPriceRange.upper)&&(n=!1),n})}extractUniqueVendors(e){let t={};return e.forEach(n=>{t[n.vendor._id]||(t[n.vendor._id]=n.vendor)}),Object.values(t)}static{this.\u0275fac=function(t){return new(t||r)(m(R),m(O),m(N),m(A))}}static{this.\u0275cmp=x({type:r,selectors:[["app-all-items"]],standalone:!1,decls:13,vars:2,consts:[[1,"ion-no-border"],["slot","start"],[3,"click"],["slot","icon-only","name","arrow-back"],["placeholder","Search offer Items",1,"custom",3,"ionInput","debounce"],[1,"menus-offer-container"],[1,"grid-container"],["class","item",4,"ngFor","ngForOf"],["slot","fixed","vertical","bottom","horizontal","end"],["name","filter-circle"],[1,"item"],[1,"img","box"],["class","ribbon-2",4,"ngIf"],[3,"src"],[1,"content-container"],[1,"item-name"],[1,"vendor-name"],[1,"price-box"],[1,"actual-price"],[1,"offer-price"],[1,"cart-btn"],[1,"less-btn"],[1,"add-btn"],[1,"ribbon-2"]],template:function(t,n){t&1&&(o(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1)(3,"ion-button",2),f("click",function(){return n.cancel()}),p(4,"ion-icon",3),i(),o(5,"ion-searchbar",4),f("ionInput",function(h){return n.handleSearchInput(h)}),i()()()(),o(6,"ion-content")(7,"div",5)(8,"div",6),_(9,V,22,7,"div",7),i()(),o(10,"ion-fab",8)(11,"ion-fab-button",2),f("click",function(h){return n.presentPopover(h)}),p(12,"ion-icon",9),i()()()),t&2&&(a(5),d("debounce",1e3),a(4),d("ngForOf",n.featuredItems))},dependencies:[b,C,I,y,S,F,w,T,B,E,k,M],styles:[".menus-offer-container[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(162px,1fr));gap:10px;padding:10px}.menus-offer-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{background-color:#fff;border:solid 1px #fff;height:245px;width:100%;padding:0;border-radius:5px;box-shadow:#63636333 0 2px 8px}.menus-offer-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .img[_ngcontent-%COMP%]{height:45%;width:100%;background-color:#ffb4b4;border-radius:5px}.menus-offer-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:100%;width:100%;border-radius:5px}.menus-offer-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .content-container[_ngcontent-%COMP%]{height:50%;position:relative;padding:5px}.menus-offer-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .content-container[_ngcontent-%COMP%]   .item-name[_ngcontent-%COMP%]{font-family:latoBold;font-size:14px;margin-bottom:2px}.menus-offer-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .content-container[_ngcontent-%COMP%]   .vendor-name[_ngcontent-%COMP%]{font-size:14px;color:gray;margin-bottom:5px}.menus-offer-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .content-container[_ngcontent-%COMP%]   .price-box[_ngcontent-%COMP%]{font-size:14px;display:flex;gap:10px;margin-bottom:5px}.menus-offer-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .content-container[_ngcontent-%COMP%]   .price-box[_ngcontent-%COMP%]   .actual-price[_ngcontent-%COMP%]{font-size:14px;text-decoration:line-through;color:#f87171;font-family:latoBold}.menus-offer-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .content-container[_ngcontent-%COMP%]   .price-box[_ngcontent-%COMP%]   .offer-price[_ngcontent-%COMP%]{font-size:14px;color:var(--ion-color-primary);font-family:latoBold}.menus-offer-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .cart-btn[_ngcontent-%COMP%]{position:absolute;bottom:5px;height:25px;width:calc(100% - 60px);background-color:var(--ion-color-secondary);margin-left:auto;margin-right:auto;border-radius:5px;display:flex;align-items:center;justify-content:space-between;left:20%;box-shadow:#0000000d 0 0 0 1px}.menus-offer-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .cart-btn[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-family:latoBold;color:#fff;font-size:16px}.menus-offer-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .cart-btn[_ngcontent-%COMP%]   .less-btn[_ngcontent-%COMP%], .menus-offer-container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .cart-btn[_ngcontent-%COMP%]   .add-btn[_ngcontent-%COMP%]{height:25px;width:25px;border:none;background-color:#fff;color:#000;border-radius:5px;font-family:latoBold;font-size:18px}.ribbon-2[_ngcontent-%COMP%]{--f: 10px;--r: 15px;--t: 10px;position:absolute;inset:var(--t) calc(-1 * var(--f)) auto auto;padding:6px 10px var(--f) calc(10px + var(--r));clip-path:polygon(0 0,100% 0,100% calc(100% - var(--f)),calc(100% - var(--f)) 100%,calc(100% - var(--f)) calc(100% - var(--f)),0 calc(100% - var(--f)),var(--r) calc(50% - var(--f) / 2));background:#bd1550;box-shadow:0 calc(-1 * var(--f)) 0 inset #0005;font-size:14px;padding-right:15px!important;color:#fff;font-family:latoBold}.box[_ngcontent-%COMP%]{background:#add8e6;position:relative}"]})}}return r})();export{K as a};
