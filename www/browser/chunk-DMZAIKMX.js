import{a as re}from"./chunk-Z2KZOCWM.js";import{a as ie}from"./chunk-JR4HINUQ.js";import{a as f}from"./chunk-XHGNJCDU.js";import{a as c}from"./chunk-G4T32QEI.js";import{$a as Q,A as I,H as l,I as y,Ia as R,Ka as N,Q as B,Qa as H,Ra as $,Sa as V,Ta as W,Ua as z,Wa as q,X as L,Xa as G,Y as O,Za as J,_a as K,ba as j,d as w,e as p,f as u,fa as E,fb as X,g as C,h as M,ia as h,ja as F,l as D,la as x,m as n,mb as Y,o as a,ob as Z,p as k,q as g,r as P,s as d,sb as ee,t as r,u as s,v as S,vb as te,wa as U,y as T,z as b,zb as oe}from"./chunk-BSY4Q6LD.js";import"./chunk-B3I3XDBM.js";import"./chunk-QUJFQN2Y.js";import"./chunk-KSM42KW3.js";import"./chunk-KAYW723Y.js";import"./chunk-ZJWVYB4W.js";import"./chunk-WVHTM5RI.js";import"./chunk-IN6HLDFE.js";import"./chunk-GIMG75PD.js";import"./chunk-O5IUGFKF.js";import"./chunk-LHDZOLCP.js";import"./chunk-AEZ3F2AP.js";import"./chunk-7FY2OE2O.js";import"./chunk-5KM5ZX5B.js";import"./chunk-EAHJVID6.js";import"./chunk-FOH2II3V.js";import"./chunk-VZWY4NEG.js";import"./chunk-WI5MSH4N.js";import"./chunk-5SJVYNIP.js";import"./chunk-CKP3SGE2.js";import"./chunk-QLR5SVGL.js";import{e as _}from"./chunk-JHI3MBHO.js";var v=(()=>{class i{constructor(t,e,o){this.webservice=t,this.router=e,this.storageServie=o}getAllAddressByUserId(t){return this.webservice.get(`address/getAllAddressesByUserId/${t}`)}updateAddressStatusById(t,e){return this.webservice.patch(`address/updateAddressStatusById/${t}`,e)}deleteAddressById(t,e){return this.webservice.post(`address/deleteAddressById/${t}`,e)}static{this.\u0275fac=function(e){return new(e||i)(u(f),u(h),u(c))}}static{this.\u0275prov=w({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var ue=()=>["/shared/location-setup"];function ge(i,ae){if(i&1){let t=T();r(0,"ion-item",8),b("click",function(){let o=C(t).$implicit,m=I();return M(m.presentActionSheet(o._id))}),r(1,"ion-avatar",9),S(2,"img",10),s(),r(3,"ion-row",11)(4,"ion-col",12)(5,"ion-label",13),l(6),s()(),r(7,"ion-col",12)(8,"ion-label",14),l(9),s()()()()}if(i&2){let t=ae.$implicit,e=I();n(),d("ngClass",t.defaultAddress?"selected":"not-selected"),n(),d("alt",t.addressType)("src",e.getImageSource(t.addressType),D),n(4),y(t.addressType),n(3),y(t.fullAddress)}}var se=(()=>{class i{constructor(t,e,o,m,ce,de){this.actionSheetController=t,this.addressService=e,this.commonService=o,this.storageService=m,this.router=ce,this.eventBus=de}ngOnInit(){}ionViewWillEnter(){this.userData=this.storageService.getUser(),this.userData?this.getAllAddressByUserId(this.userData._id):this.commonService.presentToast("bottom","User details not found!","danger")}getAllAddressByUserId(t){this.addressService.getAllAddressByUserId(t).subscribe({next:e=>{e.status?e.data?this.savedAddresses=e.data:this.savedAddresses=[]:this.commonService.presentToast("bottom",e.message,"danger")},error:e=>{this.commonService.presentToast("bottom",e.error.message?e.error.message:"Error while fetching address!","danger")},complete:()=>{}})}setAsDefaultAddress(t){if(this.userData){let e={userId:this.userData._id,defaultAddress:!0};this.addressService.updateAddressStatusById(t,e).subscribe({next:o=>{o.status?(this.commonService.presentToast("bottom",o.message,"success"),this.getAllAddressByUserId(this.userData._id),this.emitEvent()):this.commonService.presentToast("bottom",o.message,"danger")},error:o=>{this.commonService.presentToast("bottom",o.error.message?o.error.message:"Error while updating address!","danger")},complete:()=>{}})}else this.commonService.presentToast("bottom","User details not found!","danger")}deleteAddressById(t){if(this.userData){let e={userId:this.userData._id};this.addressService.deleteAddressById(t,e).subscribe({next:o=>{o.status?(this.commonService.presentToast("bottom",o.message,"success"),this.getAllAddressByUserId(this.userData._id),this.emitEvent()):this.commonService.presentToast("bottom",o.message,"danger")},error:o=>{this.commonService.presentToast("bottom",o.error.message?o.error.message:"Error while deleting address!","danger")},complete:()=>{}})}else this.commonService.presentToast("bottom","User details not found!","danger")}getImageSource(t){switch(t){case"Home":return"assets/home.png";case"officeWork":return"assets/office.png";case"others":return"assets/others.png";default:return"assets/default.png"}}presentActionSheet(t){return _(this,null,function*(){let e=yield this.actionSheetController.create({header:"Actions",cssClass:"my-custom-class",buttons:[{text:"Set As Default",role:"destructive",icon:"checkmark-circle-outline",handler:()=>{console.log("setAsDefault clicked"),this.setAsDefaultAddress(t)}},{text:"Delete",role:"destructive",icon:"trash",handler:()=>{console.log("Delete clicked"),this.deleteAddressById(t)}},{text:"Cancel",icon:"close",role:"cancel",handler:()=>{console.log("Cancel clicked")}}]});yield e.present();let{role:o}=yield e.onDidDismiss();console.log("onDidDismiss resolved with role",o)})}navigateToHome(){this.router.navigate(["/tabs"])}emitEvent(){let t={message:"Address Updated"};this.eventBus.emit("address-updated",t)}static{this.\u0275fac=function(e){return new(e||i)(a(te),a(v),a(ie),a(c),a(h),a(re))}}static{this.\u0275cmp=k({type:i,selectors:[["app-location-setup"]],standalone:!1,decls:16,vars:3,consts:[[1,"ion-no-border"],[1,"address-list-container"],[3,"click",4,"ngFor","ngForOf"],[1,"add-fab-btn"],["color","primary",2,"--box-shadow","none",3,"routerLink"],["name","add"],[1,"submit-btn"],["expand","block","color","secondary","fill","solid",3,"click"],[3,"click"],["aria-hidden","true","slot","start",3,"ngClass"],[3,"alt","src"],[1,"row-container",2,"width","100%"],["size","12"],[1,"addr-title"],[1,"address-content"]],template:function(e,o){e&1&&(r(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),l(3,"Setup your location"),s()()(),r(4,"ion-content")(5,"div",1)(6,"ion-list"),P(7,ge,10,5,"ion-item",2),s()(),r(8,"div",3)(9,"ion-fab")(10,"ion-fab-button",4),S(11,"ion-icon",5),s()()()(),r(12,"ion-footer")(13,"div",6)(14,"ion-button",7),b("click",function(){return o.navigateToHome()}),l(15,"Submit"),s()()()),e&2&&(n(7),d("ngForOf",o.savedAddresses),n(3),d("routerLink",B(2,ue)))},dependencies:[L,O,R,N,H,$,V,W,z,q,G,J,K,Q,X,Y,Z,ee,F],styles:[".map[_ngcontent-%COMP%]{position:absolute;height:100%;width:100%;background-color:transparent;opacity:0;transition:opacity .15s ease-in}.map.visible[_ngcontent-%COMP%]{opacity:1}.row-container[_ngcontent-%COMP%]{width:100%}.row-container[_ngcontent-%COMP%]   .addr-title[_ngcontent-%COMP%]{font-family:latoBold!important}.row-container[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:14px}.addr-form-container[_ngcontent-%COMP%]{padding:10px;margin:10px;box-shadow:#63636333 0 2px 8px;border-radius:10px;height:200px}.add-fab-btn[_ngcontent-%COMP%]{position:absolute;bottom:80px;right:70px}.address-content[_ngcontent-%COMP%]{text-overflow:unset;white-space:normal}.selected[_ngcontent-%COMP%]{border:3px solid var(--ion-color-success);padding:3px;background-clip:content-box}.not-selected[_ngcontent-%COMP%]{border:3px solid var(--ion-color-primary);padding:3px;background-clip:content-box}"]})}}return i})();var he=[{path:"",component:se}],ne=(()=>{class i{static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275mod=g({type:i})}static{this.\u0275inj=p({imports:[x.forChild(he),x]})}}return i})();var Ee=(()=>{class i{static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275mod=g({type:i})}static{this.\u0275inj=p({providers:[f,v,c],imports:[j,U,oe,ne,E]})}}return i})();export{Ee as LocationSetupPageModule};
